# Amazon Pilot Caddy配置文件 - 简化版
# 使用方法：在主Caddyfile中添加 import /etc/caddy/caddy-amazon-pilot.conf

# 主应用
amazon-pilot.phpman.top {
    # API路由（优先匹配）
    handle /api/* {
        reverse_proxy localhost:8080
    }

    # 前端应用（默认路由）
    handle {
        reverse_proxy localhost:4000
    }

    # 访问日志
    log {
        output file /var/log/caddy/amazon-pilot-access.log {
            roll_size 100mb
            roll_keep 5
        }
        format json
    }
}

# 任务监控界面（无认证）
monitor-amazon-pilot.phpman.top {
    reverse_proxy localhost:5555
}

# Grafana监控界面（无认证）
grafana-amazon-pilot.phpman.top {
    reverse_proxy localhost:3001
}

# API直接访问（无认证）
api-amazon-pilot.phpman.top {
    reverse_proxy localhost:8080
}